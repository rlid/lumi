{% macro render_track_record(user, engagements) %}
    <table class="table">
        <thead>
        <tr>
            <th scope="col">Date</th>
            <th scope="col">Value</th>
            <th scope="col">Role</th>
            <th scope="col">Success?</th>
            <th scope="col">Dispute?</th>
        </tr>
        </thead>
        <tbody>
        {% for engagement in engagements %}
            {% set is_success = engagement.rating_by_asker == engagement.rating_by_answerer == 1 %}
            {% set is_dispute = engagement.rating_by_asker == -1 and engagement.rating_by_answerer == 1 %}
            <tr class="table-{%- if is_success -%}success{%- elif is_dispute -%}danger{%- else -%}secondary{%- endif -%}">
                <th scope="row">{{ moment(engagement.last_updated).format('HH:mm:ss') }}</th>
                <td>{{ '{0:.2f}'.format(0.01 * engagement.node.value_cent) }}</td>
                <td>{% if user.id == engagement.asker_id %}
                    Buyer
                {% elif user.id == engagement.answerer_id %}
                    Seller
                {% endif %}
                </td>
                <td>{{ is_success }}</td>
                <td>{{ is_dispute }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endmacro %}




{% macro render_reward_info(node) %}
    {% set post = node.post %}
    {% if current_user == post.creator %}
        {% set n_nodes = post.nodes.count() - 1 %}
        <div class="alert alert-success bg-white alert-dismissible fade show small py-2" role="alert">
            {% if n_nodes > 0 %}
                {{ n_nodes }} {% if n_nodes > 1 %}users{% else %}user{% endif %} have shared or contributed to this
                post.
            {% elif post.social_media_mode %}
                Share your post and let others join the search! Send it to your friends or share it on Twitter,
                Facebook, Twitter, Reddit... whatever your favorite online community is. Your post is in
                <b>Social Media Mode</b>, which means it solely relies on the power of your social networks to reach
                the people you are looking for.
            {% else %}
                Share your post and let others join the search! Send it to your friends or share it on Twitter,
                Facebook, Twitter, Reddit... whatever your favorite online community is.
            {% endif %}
            <button type="button" class="btn-close small mt-1 py-2 pe-1" data-bs-dismiss="alert"></button>
        </div>
        <div class="alert alert-success bg-white alert-dismissible fade show small py-2" role="alert">
            {% if post.type == Post.TYPE_BUY %}
                Upon successful engagement, you pay {{ '${0:.2f}'.format(0.01 * node.value_cent) }}, of which:
                <ul class="mb-0">
                    <li>up to {{ '${0:.2f}'.format(0.01 * post.referral_budget_cent) }} goes to the referrers</li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * post.platform_fee_cent) }} is the platform fee
                    </li>
                    <li>
                        the remaining amount goes to the seller
                    </li>
                </ul>
            {% else %}
                Upon successful engagement, buyer pays :
                <ul class="mb-0">
                    <li>
                        {{ '${0:.2f}'.format(0.01 * node.answerer_reward_cent) }} to you
                    </li>
                    <li>up to {{ '${0:.2f}'.format(0.01 * post.referral_budget_cent) }} to the referrers</li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * post.platform_fee_cent) }} as the platform fee
                    </li>
                </ul>
            {% endif %}
            <button type="button" class="btn-close small mt-1 py-2 pe-1" data-bs-dismiss="alert"></button>
        </div>
    {% elif current_user == node.creator %}
        <div class="alert alert-success bg-white alert-dismissible fade show small py-2" role="alert">
            <b>Share</b> - you can earn up to
            {{ '${0:.2f}'.format(node.display_referrer_reward(current_user)) }}
            for each successful engagement your referral leads to, or
            <p></p>
            {% if post.type == Post.TYPE_SELL %}
                <b>Request for Engagement</b> - you pay {{ '${0:.2f}'.format(0.01 * node.value_cent) }} upon
                successful engagement, of which:
                <ul class="mb-0">
                    <li>{{ '${0:.2f}'.format(0.01 * node.sum_referrer_reward_cent) }} goes to the referrers</li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * post.platform_fee_cent) }} is the platform fee
                    </li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * node.answerer_reward_cent) }} goes to the seller
                    </li>
                </ul>
            {% else %}
                <b>Request for Engagement</b> - buyer pays {{ '${0:.2f}'.format(0.01 * node.value_cent) }} upon
                successful engagement, of which:
                <ul class="mb-0">
                    <li>{{ '${0:.2f}'.format(0.01 * node.sum_referrer_reward_cent) }} goes to the referrers</li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * post.platform_fee_cent) }} is the platform fee
                    </li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * node.answerer_reward_cent) }} goes to you
                    </li>
                </ul>
            {% endif %}
            <button type="button" class="btn-close small mt-1 py-2 pe-1" data-bs-dismiss="alert"></button>
        </div>
    {% else %}
        {% set answerer_reward_cent, sum_referrer_reward_cent, value_cent = node.rewards_for_next_node_cent() %}
        <div class="alert alert-success bg-white alert-dismissible fade show small py-2" role="alert">
            <b>Share</b> - you can earn up to
            {{ '${0:.2f}'.format(node.display_referrer_reward(current_user)) }}
            for each successful engagement your referral leads to, or
            <p></p>
            {% if post.type == Post.TYPE_SELL %}
                <b>Request for Engagement</b> - you pay {{ '${0:.2f}'.format(0.01 * value_cent) }} upon successful
                engagement, of which:
                <ul class="mb-0">
                    <li>{{ '${0:.2f}'.format(0.01 * sum_referrer_reward_cent) }} goes to the referrers</li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * post.platform_fee_cent) }} is the platform fee
                    </li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * answerer_reward_cent) }} goes to the seller
                    </li>
                </ul>
            {% else %}
                <b>Request for Engagement</b> - buyer pays {{ '${0:.2f}'.format(0.01 * value_cent) }} upon successful
                engagement, of which:
                <ul class="mb-0">
                    <li>{{ '${0:.2f}'.format(0.01 * sum_referrer_reward_cent) }} goes to the referrers</li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * post.platform_fee_cent) }} is the platform fee
                    </li>
                    <li>
                        {{ '${0:.2f}'.format(0.01 * answerer_reward_cent) }} goes to you
                    </li>
                </ul>
            {% endif %}
            <button type="button" class="btn-close small mt-1 py-2 pe-1" data-bs-dismiss="alert"></button>
        </div>
    {% endif %}
{% endmacro %}